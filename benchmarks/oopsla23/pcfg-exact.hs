#!/usr/bin/runhaskell

-- Use a handwritten formula to compute the exact probability of string $length
-- generated by the PCFG
--   S -> SS (probability $prob)
--   S -> a  (probability 1-$prob)

import Data.List (inits)

answers :: Double -> [Double]
answers p = 0 : rs
  where rs = (1-p) : map ((p *) . sum . zipWith (*) rs . reverse) (tail (inits rs))

main :: IO ()
main = mapM_ (\(i,r) -> putStrLn (show i ++ "\t" ++ show r))
             (take 101 (zip [0..] (answers 0.1)))
